<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Summary Batch</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/styles.css" />
    <link rel="stylesheet" href="/summary.css" />
  </head>
  <body>
    <nav class="main-nav">
      <a href="/index.html">Input Order</a>
      <a href="/summary.html" class="active">Summary</a>
      <a href="/stock.html">Stok</a>
    </nav>

    <div class="container">
      <h1>Summary Order</h1>
      <p class="desc">Ringkasan pesanan per batch.</p>

      <div id="alertError" class="alert error" role="alert" aria-live="assertive"></div>
      
      <div class="batch-controls">
        <div class="batch-combobox">
          <div class="combobox-container">
            <input
              id="batch"
              name="batch"
              type="text"
              placeholder="Ketik atau pilih batch..."
              class="combobox-input"
            />
            <button type="button" class="combobox-toggle" id="batchToggle">
              ▼
            </button>
          </div>
          <div class="combobox-dropdown" id="batchDropdown">
            <!-- Opsi batch akan diisi oleh JavaScript -->
          </div>
        </div>
        <button type="button" id="generateBatchBtn" class="inline secondary">
          Batch Minggu Ini
        </button>
        <button type="button" id="loadBtn">Muat Summary</button>
      </div>

      <p class="caption" id="meta"></p>

      <!-- Combined Summary Section -->
      <div class="combined-summary">
        <!-- Size Summary -->
        <div id="sizeSummary" class="size-summary hidden">
          <div class="size-cards">
            <!-- Cards akan diisi oleh JavaScript -->
          </div>
        </div>
        <!-- Revenue Summary Cards -->
        <div class="revenue-summary">
          <div class="summary-card">
            <div class="label">Jumlah Order</div>
            <div class="value" id="totalOrdersCard">0</div>
          </div>
          <div class="summary-card revenue-card">
            <div class="label">Total Pendapatan</div>
            <div class="value" id="totalRevenueCard">Rp 0</div>
          </div>
        </div>
      </div>
      
      <div class="table-wrapper">
        <table id="summaryTable">
          <thead>
            <tr>
              <th>Jenis Jamu</th>
              <th>Ukuran</th>
              <th>Option</th>
              <th>Jumlah</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <h2 class="section-title">Per Customer</h2>

      <div class="mobile-sort-container" style="display: none;">
        <select id="mobileSort" class="sort-select">
          <option value="name-asc">Nama A-Z</option>
          <option value="name-desc">Nama Z-A</option>
          <option value="qty-desc">Total Botol ↓</option>
          <option value="qty-asc">Total Botol ↑</option>
          <option value="amount-desc">Total Tagihan ↓</option>
          <option value="amount-asc">Total Tagihan ↑</option>
          <option value="status">Status</option>
        </select>
      </div>

      <div class="table-wrapper">
        <table id="customersTable">
          <thead>
            <tr>
              <th>Customer</th>
              <th>Total Botol</th>
              <th>Total Tagihan</th>
              <th>Status</th>
              <th>Detail</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- Mobile Customer Cards -->
      <div id="mobileCustomerCards" class="mobile-customer-cards">
        <!-- Customer cards akan diisi oleh JavaScript -->
      </div>
    </div>

    <!-- Modal for Status Update -->
    <!-- <div id="mobileStatusModal" class="mobile-status-modal"> -->
      <!-- Modal content will be filled by JavaScript -->
    <!-- </div> -->

    <!-- Modal for Edit Order -->
    <div id="editOrderModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Edit Order</h2>
          <button type="button" class="modal-close" onclick="closeEditModal()">×</button>
        </div>
        <form id="editOrderForm">
          <div class="form-group">
            <label for="editCustomerName">Nama Customer</label>
            <input
              type="text"
              id="editCustomerName"
              name="customerName"
              required
              readonly
              class="readonly-input"
            >
          </div>

          <div class="form-group">
            <label for="editBatch">Batch</label>
            <input
              type="text"
              id="editBatch"
              name="batch"
              required
              readonly
              class="readonly-input"
            >
          </div>

          <div class="form-group">
            <label for="editNotes">Catatan</label>
            <textarea
              id="editNotes"
              name="notes"
              rows="3"
              placeholder="Catatan untuk order ini..."
            ></textarea>
          </div>

          <fieldset class="items-fieldset">
            <legend>Item Pesanan</legend>
            <div id="editItemsContainer" class="items-container">
              <!-- Item rows akan diisi oleh JavaScript -->
            </div>
            <button type="button" class="secondary" onclick="addEditItemRow()">
              + Tambah Item
            </button>
            <small class="field-error" id="error-editItems"></small>
          </fieldset>

          <div class="form-actions">
            <button type="submit" class="btn-primary">Update Order</button>
            <button type="button" class="btn-secondary" onclick="closeEditModal()">Batal</button>
          </div>
        </form>
      </div>
    </div>

    <script src="/js/utils.js"></script>
    <script src="/js/summary.js"></script>
  </body>
</html>